import{af as f,W as p,n as C,ah as _}from"./index-443870ad.js";var s=globalThis&&globalThis.__awaiter||function(i,t,n,h){function o(e){return e instanceof n?e:new n(function(a){a(e)})}return new(n||(n=Promise))(function(e,a){function m(c){try{r(h.next(c))}catch(u){a(u)}}function l(c){try{r(h.throw(c))}catch(u){a(u)}}function r(c){c.done?e(c.value):o(c.value).then(m,l)}r((h=h.apply(i,t||[])).next())})};class d{constructor(t="https://registry.ping.pub"){this.endpoint=t}getAny(t){return s(this,void 0,void 0,function*(){return f(`${this.endpoint}${t}`).then(n=>n.json())})}get(t){return s(this,void 0,void 0,function*(){return f(`${this.endpoint}${t}`).then(n=>n.json())})}fetchChainNames(){return s(this,void 0,void 0,function*(){return(yield this.get("/")).filter(n=>n.type==="directory"&&n.name!=="testnet"&&!n.name.startsWith("_")).map(n=>n.name)})}fetchChainInfo(t){return s(this,void 0,void 0,function*(){return this.get(`/${t}/chain.json`)})}fetchAssetsList(t){return s(this,void 0,void 0,function*(){return this.get(`/${t}/assetlist.json`)})}fetchIBCPaths(){return s(this,void 0,void 0,function*(){const t=yield this.get("/_IBC/"),n=/([\w]+)-([\w]+)\.json/;return t.map(h=>{const o=h.name.match(n),e={};return e.path=h.name,e.from=o[1],e.to=o[2],e})})}fetchIBCPathInfo(t){return s(this,void 0,void 0,function*(){return yield this.get(`/_IBC/${t}`)})}}const g=p("module-ibc",{state:()=>({paths:[],connectionId:"",registryConf:{}}),getters:{chain(){return C()},commonIBCs(){return this.paths.filter(i=>{var t;return i.path.search(((t=this.chain.current)==null?void 0:t.prettyName)||this.chain.chainName)>-1})},sourceField(){var i,t,n;return((t=(i=this.registryConf)==null?void 0:i.chain_1)==null?void 0:t.chain_name)===((n=this.chain.current)==null?void 0:n.prettyName)||this.chain.chainName?"chain_1":"chain_2"},destField(){var i,t,n;return((t=(i=this.registryConf)==null?void 0:i.chain_1)==null?void 0:t.chain_name)===((n=this.chain.current)==null?void 0:n.prettyName)||this.chain.chainName?"chain_2":"chain_1"},registryChannels(){return this.registryConf.channels}},actions:{load(){new d().fetchIBCPaths().then(t=>{this.paths=t})},fetchConnection(i){new d().fetchIBCPathInfo(i).then(n=>{var e;const o=n.chain_1.chain_name===((e=this.chain.current)==null?void 0:e.prettyName)||n.chain_1.chain_name===this.chain.chainName?n.chain_1.connection_id:n.chain_2.connection_id;this.registryConf=n,this.showConnection(o)})},showConnection(i){i||(this.registryConf={});const t=`/${this.chain.chainName}/ibc/connection/${i||`connection-${this.connectionId||0}`}`;_.push(t)}}});export{g as u};
